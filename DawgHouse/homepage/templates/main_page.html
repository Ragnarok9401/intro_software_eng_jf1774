<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    {% load static %}
    <style>
        .hidden-link {
            text-decoration: none;
            color: inherit;
        }
        .hidden-link:hover {
            text-decoration: none;
        }
    </style>
    <link rel="stylesheet" type="text/css" href="{% static 'homepage.css' %}"/>
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"> <!--icons-->

    <title>Homepage</title>
</head>
<body>
<div class="box">
    <div class="sidebar">
        <p> DawgHouse </p>
        <ul>
            <li>
                <a href="" class="active">
                    <span class="icon"><i class='bx bx-home'></i></span>
                    <span class="item">Home</span>
                </a>
            </li>
            <li>
                <a href="{% url 'profile' user.username %}">
                    <span class="icon"><i class='bx bx-user-circle'></i></span>
                    <span class="item">Profile</span>
                </a>
            </li>
            <li>
                <a href="{% url 'accept_example' %}">
                    <span class="icon"><i class='bx bxs-dog'></i></span>
                    <span class="item">Sniff</span>
                </a>
            </li>
            <li>
                <a href="{% url 'logout_view' %}" class="active">
                    <span class="icon"><i class='bx bx-log-out'></i></span>
                    <span class="item">Logout</span>
                </a>
            </li>
        </ul>
    </div>
</div>
<div class="searchbar">
    <form action="{% url 'search_users' %}" method="post">
        {% csrf_token %}
        <input type="text" placeholder="Search by Dawgtag..." name="username">
        <button type="submit"><i class='bx bx-search'></i></button>
    </form>
</div>
<div class="timeline">
</div>

<div class="barks-container">
    <h2>Timeline</h2>
    <ul>
      {% for bark in barks %}
      <!--lists of barks-->
      <li class="bark">
        <div class="bark-header">
          {% if bark.is_repost %}
          <h3>Reposted From: {{ bark.original_bark.user.username }}</h3>
        {% endif %}
            <h3>{{ user.first_name }} {{ user.last_name }}</h3>
            <p class="timestamp">{{ bark.timestamp }}</p>
        </div>
        <h4>@{{ user.username }}</h4>
        <hr color="maroon"> <!--line-->
        <!--content of barks-->
        <div class="bark-content-display">
          <p id="bark-content-{{ bark.id }}">{{ bark.content }}</p>
            
        </div>
        <!--shows number of yips and treats (yips needs functionality)-->
        <div class="counters-container">
          <h4 class="counters-container">
            <strong>{{ bark.num_likes }}</strong> Treats
            <span class="comment-counter"><strong>{{ bark.num_yips }}</strong> Yips</span> <!--needs backend-->
          </h4>
        </div>
        <hr> <!--line-->
        <!--contains the buttons for counters (Yip and Howl need functionality)-->
        <div class="button-container">
          <!--this is how I set up only allowing one treat per user. Button is maroon if already given treat-->
          <form action="{% url 'give_treat_homepage' bark.id user.username %}" method="post">
            {% csrf_token %} {% if user in bark.treated_by.all %}
            <button type="submit" style="background-color: rgb(70, 18, 18)"><i class="fa-solid fa-bone" style="color:white;"></i> Treat</button>
            {% else %}
            <button type="submit"><i class="fa-solid fa-bone" style="color:white;"></i> Treat</button>
            {% endif %}
          </form>
          <!-- needs backend -->
          <button class="show-comment-input" data-bark-id="{{ bark.id }}"><i class="fa-solid fa-dog" style="color:white;"></i> Yip</button>

          <div id="comment-input-{{ bark.id }}" style="display: none;">
              <textarea id="comment-text-{{ bark.id }}" placeholder="Add a comment" required></textarea>
              <button class="comment-button" data-bark-id="{{ bark.id }}">Post Comment</button>
          </div>
          
        
          <!-- needs backend -->
          <form method="POST" class="repost-form">
            {% csrf_token %}
            <input type="hidden" name="original_post_id" value="{{ bark.id }}">
            <button type="button" class="repost-button" data-bark-id="{{ bark.id }}">
                <i class="fa-solid fa-dog" style="color:white;"></i> Howl
            </button>
        </form>
            <!-- Placeholder -->
            <div class="comments-container">
              <h2>Comments</h2>
              <ul id="comment-list">
                  {% for comment in bark.comments.all %}
                  <li class="comment">
                      <div class="comment-header">
                          <h5 class="username">{{ comment.name.username }}</h5>
                          <p class="timestamp">{{ comment.date_added }}</p>
                      </div>
                      <div class="comment-content-display">
                          <p>{{ comment.body }}</p>
                          <button class="delete-comment" data-comment-id="{{ comment.id }}">Delete</button>
                      </div>
                  </li>
                  {% endfor %}
              </ul>
          </div>
          

    {% endfor %}
    </ul>
  </div>

</body>
</html>







